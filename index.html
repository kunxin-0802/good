<!--
	此示例下载自 https://echarts.apache.org/examples/zh/editor.html?c=mix-timeline-finance&code=G4QwTgBAJiAuIFkQAcIF4IG8C-BuAsAFABmArgHYDGsAlgPbnRwgBidYAtnLAKZgAUdAEYArAJRYiECKEjIAMjQDOsdBADaAckB8noCx5QLvygHLTA5AaA2U0CmipoA0ETYHm_QKQhZyzc2AiWMDlcs-u3AbdqBavUAbeMBvz28AXQJCaVkIXg5kSOlidgh-GIBPHnA1ACYABgBGPNwITOyAHgx8nIKSsrAAagaJTClpCBpiVOERdXqwlrb2mWyuAA81YqH2mKVSDknE4dieeLUevqywCOmklLTsmkmbABs1OOQAOhOecgBzWAALEqPyiBOXpsGo5elxtSQT0u4344xsF3UNAGS1-cwWDQwEKhMOWG36kLCalaP1-0nIIA4PAAXBAFMpYBirLtlqATqRiSt4hjqdI8NTsNS0VsIA1bONNJiMIDHpdiCc6OxQSAJgB6CBFPISABU8ryUxx7S52V5mjhArUcJRHJ-xukYB4sFIYEYPUixqIMrlAElyDRaCATjQAF48JjwIgweBIK5WoQgcgAEWYakDrHYXFgvAE2Ok-SKJPUAA4AGyXTM2XP5iA5S4FGwAZlLYSpPzTABYMwB2ACclzrNlbRcrRdzzerbWqBQz2aLjcu2Zs-Uu5ZsdarRGwYkiAeYwcuYCtHqj8BjzDYnG4fH4KeLhTyGYKmcujYrORsBVzAFZ7yXM_3a4UGxpyxOIOXmwW959jWqZ5DUGZ1iWN5_r2HZ5veeTjmEC5LkQRB0MgtAMFibRhpQADWdxgHQFBQAAwnQ4pgCSmgAMTEHkxBMXk1i4SASg8AA8ph9DkCSJ7SLQhKeuQDICe00rKAAKukyAMpolBwDwdzsOkrEatIICkLAdAAAonCA6QkrAG48CByzIAZ6QukmtIkgqeTmcMsYZpoaZ5AAtIUXkFD4bmfj5Pl-YOgWFAKTntAZQg8Cc_EshAyQHomfAkmQVBYYw_BKN8uLtOalrWhAokAO4QNuPBZWIlx3BaLCkCcJwAJpbPwqEae0prLJ1rIRbQsA3HF7W8GMsA0YAYEqAHPqgCGcoAiEaAL9qgCAAYALnqAF1yFiAMt-gAh5upsKkEIw2jbYgAOpoAdsaAKbmgBXgYAtHKLYAIfmAIuegBm2oAKB6AG5eV2AMP6O3LDpyD2Y51I3MQh2aEDsCaNM2C9RKJy0H9khDWANB3DV1G2JJSjfcMGO6XQNDkEmg25bAsnyUojwgFAdDFRD7VQ9SiUJoTCUUNQvH8Mg4AEtlCO5TcqjmnMsNqJzYDc-oeRhJc-KEjytjlEIYAygAfJoKLDKL3OiuwACiICUI8HNcwsaDK7zuUQIL9WqAiEAAAYACSYJrHCXBxSM8EoAByBI8NgJJOy7ly0vS2AAKQK0ryt2-rHVtbl-VWowVuw7H3UQPTGo3DV5BQETywuRoOgGCYFh-Y43iuJ4ld-EEoRl--vy_SS5YA-1SN3I8h2Pm3Tc8CNADKJMDebvyUJR7A0bR5Yz7Tvzp5nwxETQeej5FPDAzR5Zh1jeXI13NF1jvEWCRhNEFI-x_UkIdCJnQHBb1f7XjwTID4_IIDRbFsSmZDEVjAAQTGMofOwwSZyRoopXgKkwBqRPn6EArkJqAHFUvygAcxUAIrm4VqQY0UKJUBywRI8CHukEe4kx4TzRnRbMNC564nTj1HBwClAfy_gQ4Y48qJTxnuWOhwwF4RXSEAkBa9BKkxoiHHgu88S-xooAFetADhzoACH-w6AEh_6REAOD4xJI5ZYjoICAC-1QAWdqAABzQA8DqAB4FPIYdqTjH-ro6Q-jjEmMAOSaFiFQ2Pargz-MV2HtEZoeKhmBJHhw0dIThk9bDT1nuyeBuD8ZiXikQkhZD4rhMoVPGh2Y-FdVidSJQlk3R4MSe1aQyTh4lIthACJVDaJQHqTk_h7I_7THdjQT2GZqSYAgPFGW8k9BGBrvFcB8kwxgDCR0OIKTKkWxqVPOsPAWwgEbI0jqeT2rdN6bI2wFcy42GGeI2wYyJlulWNMvxHCMlROIDkTMPAchCFWaydZvxNmlKKts9wXg9k9PeSMmixz4HSFORwc5ojlhzKiTwC-jZHzNieRnF5yw3m5T6TRAIIQhl_MOZoQF8UQVgvIRCq5dFGzZiEI2IQOQEUMMRRqZCJoaxtAwhlJQnSNREr6mQlYI0aLuSWpNWai1VobW2hneBbSOkaHiiii2hd1BpPaLGNcoZwzbhAFodyAoJZS0kUCguq4UDrk3CcdVmqzzaslsHD09JFWYniovXEsrcrysVdIZVRrVWRmYOaoo2qCi6ptWZN1CC1wbjFqan1_k_VhHUAG61dIeB2t-blR1ryU1yuYOyqp7rDUhjAGGb18BfUsVjTkQNib9XOTzcaiNZro2lvUOWhNtr3nSHte8tNyKM0uqzdKttSqa1evrVq2N5YK30irYOoMRrw1bijaO9Q46W1JoHR21N1IGX8Iipyt03KDp8s_AK6a81lprXMFtTQ4r8l8HaWy_tuVunyo9fmwtI7PyWonWZUNs6TXvoKHWT9K7MRduGE-vt6gX2XGHQuj9sb416p_VcOdkbi3RsA_Br9IH9XgfgBmKDMG0P1m1c2xDUGUP_ow02rD173m4cQRoAjBa1WwYA9q5dZGa0UdY1RjjQaQObpaRy6kXKxI8pBoOY9Qqz2iqvaBiAkr70Krowg_DQ7mNFo1f5GoQHOMzuQ3-2DOnY1WskdhmVqnGPqbfUZ3ymGV02HI4ZojYE7Nxpo_J6Q9G1P6egxp99xnqMOaQ7W-dLnAukf47Rx9lnIPWZY-FtzfHK0he44l9jHnBMak6gyvAQA
	⚠ 请注意，该图表不是 Apache ECharts 官方示例，而是由用户代码生成的。请注意鉴别其内容。
-->
<!DOCTYPE html>
<html lang="en" style="height: 100%">
<head>
  <meta charset="utf-8">
</head>
<body style="height: 100%; margin: 0">
  <div style="width:70%; height:100%; margin:0 auto;">

<div id="container" style="height:100%;"></div>

</div>

  
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
  
  <!-- Uncomment this line if you want to dataTool extension
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@5/dist/extension/dataTool.min.js"></script>
  -->
  <!-- Uncomment this line if you want to use gl extension
  <script type="text/javascript" src="https://echarts.apache.org/zh/js/vendors/echarts-gl/dist/echarts-gl.min.js"></script>
  -->
  <!-- Uncomment this line if you want to echarts-stat extension
  <script type="text/javascript" src="https://echarts.apache.org/zh/js/vendors/echarts-stat/dist/ecStat.min.js"></script>
  -->
  <!-- Uncomment this line if you want to echarts-graph-modularity extension
  <script type="text/javascript" src="https://echarts.apache.org/zh/js/vendors/echarts-graph-modularity/dist/echarts-graph-modularity.min.js"></script>
  -->
  <!-- Uncomment this line if you want to use map
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@4.9.0/map/js/world.js"></script>
  -->
  <!-- Uncomment these two lines if you want to use bmap extension
  <script type="text/javascript" src="https://api.map.baidu.com/api?v=3.0&ak=YOUR_API_KEY"></script>
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@5/dist/extension/bmap.min.js"></script>
  -->

  <script type="text/javascript">
    var dom = document.getElementById('container');
    var myChart = echarts.init(dom, null, {
      renderer: 'canvas',
      useDirtyRect: false
    });
    var app = {};
    
    var option;

    var dataMap = {};
function dataFormatter(obj) {
  var pList = ['社会保障性收入', '经营性收入', '财产性收入', '家庭转移性收入'];
  var temp;
  for (var year = 2010; year <= 2021; year++) {
    if (obj[year]) {
      var max = 0;
      var sum = 0;
      temp = obj[year];
      for (var i = 0, l = temp.length; i < l; i++) {
        max = Math.max(max, temp[i]);
        sum += temp[i];
        obj[year][i] = {
          name: pList[i],
          value: temp[i]
        };
      }
      obj[year + 'max'] = Math.floor(max / 100) * 100;
      obj[year + 'sum'] = sum;
    }
  }
  return obj;
}

// Initialize data
dataMap.urbanData = dataFormatter({
  2010: [86.8, 6.8, 2.1, 3.1],
  2014: [79.4, 9.8, 3.8, 6.9],
  2021: [68, 7.6, 20.3, 4.1]
});

dataMap.ruralData = dataFormatter({
  2010: [18.7, 32, 16.5, 12.8],
  2014: [36, 39, 6, 19],
  2021: [42.7, 36.9, 9.8, 10.6]
});

option = {
  backgroundColor: '#f0fff0',
  baseOption: {
    timeline: {
      axisType: 'category',
      autoPlay: true,
      playInterval: 1000,
      data: ['2010-01-01', '2014-01-01', '2021-01-01'],
      label: {
        formatter: function (s) {
          return new Date(s).getFullYear();
        }
      }
    },
    title: {
      text: '分城乡我国老年人收入结构',
      subtext: '数据来自中国老龄科学研究中心',
      top: 10,
      left: 'left'
    },
    tooltip: {
      trigger: 'axis',
      axisPointer: {
        type: 'shadow'
      },
      formatter: function(params) {
        let result = params[0].name + '<br/>';
        params.forEach(param => {
          result += `${param.seriesName}: ${param.value}%<br/>`;
        });
        return result;
      }
    },
    legend: {
      data: ['社会保障性收入', '经营性收入', '财产性收入', '家庭转移性收入'],
      top: 30,
      right: 50,
      textStyle: {
        color: '#333'
      }
    },
    grid: {
      left: '3%',
      right: '4%',
      top: '15%',
      bottom: '3%',
      containLabel: true
    },
    xAxis: {
      type: 'category',
      data: ['城镇', '农村'],
      axisLine: {
        lineStyle: {
          color: '#666'
        }
      },
      axisLabel: {
        color: '#333'
      }
    },
    yAxis: {
      type: 'value',
      name: '比率（%）',
      min: 0,     // 固定最小值0%
      max: 100,   // 固定最大值100%
      axisLabel: {
        formatter: '{value}%',
        color: '#333'
      },
      axisLine: {
        lineStyle: {
          color: '#666'
        }
      },
      splitLine: {
        lineStyle: {
          color: '#ddd'
        }
      }
    },
    series: [
      { 
        name: '社会保障性收入', 
        type: 'bar',
        itemStyle: {
          color: '#FFD700'
        }
      },
      { 
        name: '经营性收入', 
        type: 'bar',
        itemStyle: {
          color: '#98FF98'
        }
      },
      { 
        name: '财产性收入', 
        type: 'bar',
        itemStyle: {
          color: '#8FD8E8'
        }
      },
      { 
        name: '家庭转移性收入', 
        type: 'bar',
        itemStyle: {
          color: '#C7B8D1'
        }
      }
    ]
  },

  options: [
    {
      title: { text: '2010年分城乡我国老年人收入结构' },
      series: [
        { 
          data: [
            dataMap.urbanData['2010'][0].value,
            dataMap.ruralData['2010'][0].value
          ] 
        },
        { 
          data: [
            dataMap.urbanData['2010'][1].value,
            dataMap.ruralData['2010'][1].value
          ] 
        },
        { 
          data: [
            dataMap.urbanData['2010'][2].value,
            dataMap.ruralData['2010'][2].value
          ] 
        },
        { 
          data: [
            dataMap.urbanData['2010'][3].value,
            dataMap.ruralData['2010'][3].value
          ] 
        }
      ]
    },
    {
      title: { text: '2014年分城乡我国老年人收入结构' },
      series: [
        { data: [dataMap.urbanData['2014'][0].value, dataMap.ruralData['2014'][0].value] },
        { data: [dataMap.urbanData['2014'][1].value, dataMap.ruralData['2014'][1].value] },
        { data: [dataMap.urbanData['2014'][2].value, dataMap.ruralData['2014'][2].value] },
        { data: [dataMap.urbanData['2014'][3].value, dataMap.ruralData['2014'][3].value] }
      ]
    },
    {
      title: { text: '2021年分城乡我国老年人收入结构' },
      series: [
        { data: [dataMap.urbanData['2021'][0].value, dataMap.ruralData['2021'][0].value] },
        { data: [dataMap.urbanData['2021'][1].value, dataMap.ruralData['2021'][1].value] },
        { data: [dataMap.urbanData['2021'][2].value, dataMap.ruralData['2021'][2].value] },
        { data: [dataMap.urbanData['2021'][3].value, dataMap.ruralData['2021'][3].value] }
      ]
    }
  ]
};

    if (option && typeof option === 'object') {
      myChart.setOption(option);
    }

    window.addEventListener('resize', myChart.resize);
  </script>
</body>
</html>